-- Staging model for dbo.permanentchannels
-- Generated by DataMigrate AI on 2025-12-05 14:46:23

{{ config(
    materialized='view',
    schema='staging'
) }}

WITH source AS (

    SELECT
        id,
    nodeid,
    channelindex,
    pointid,
    updatedtime,
    preferred_time_interval,
    jsonstore,
    status,
    actual_flags,
    actual_sensitivity,
    actual_offset,
    actual_highalarm,
    actual_lowalarm,
    actual_rrp,
    actual_rrs,
    actual_rra,
    actual_nrba,
    actual_nrda,
    actual_nraa,
    actual_nwba,
    actual_nwda,
    actual_nwaa,
    actual_wrp,
    actual_wrs,
    actual_wra,
    actual_wdm,
    actual_wds,
    actual_wda,
    actual_autosensitivityhigh,
    actual_autosensitivitylow,
    actual_averaging,
    actual_alarmrelease,
    desired_flags,
    desired_sensitivity,
    desired_offset,
    desired_highalarm,
    desired_lowalarm,
    desired_rrp,
    desired_rrs,
    desired_rra,
    desired_nrba,
    desired_nrda,
    desired_nraa,
    desired_nwba,
    desired_nwda,
    desired_nwaa,
    desired_wrp,
    desired_wrs,
    desired_wra,
    desired_wdm,
    desired_wds,
    desired_wda,
    desired_autosensitivityhigh,
    desired_autosensitivitylow,
    desired_averaging,
    desired_alarmrelease,
    livedb,
    livepfs,
    livetime,
    livesensitivity,
    liveoffset,
    liveflags,
    actual_alarmdelay,
    actual_tlvl,
    actual_dsu,
    desired_alarmdelay,
    desired_tlvl,
    desired_dsu
    FROM {{ source('mssql_source', 'permanentchannels') }}

),

staged AS (

    SELECT
        id,
    nodeid,
    channelindex,
    pointid,
    updatedtime,
    preferred_time_interval,
    jsonstore,
    status,
    actual_flags,
    actual_sensitivity,
    actual_offset,
    actual_highalarm,
    actual_lowalarm,
    actual_rrp,
    actual_rrs,
    actual_rra,
    actual_nrba,
    actual_nrda,
    actual_nraa,
    actual_nwba,
    actual_nwda,
    actual_nwaa,
    actual_wrp,
    actual_wrs,
    actual_wra,
    actual_wdm,
    actual_wds,
    actual_wda,
    actual_autosensitivityhigh,
    actual_autosensitivitylow,
    actual_averaging,
    actual_alarmrelease,
    desired_flags,
    desired_sensitivity,
    desired_offset,
    desired_highalarm,
    desired_lowalarm,
    desired_rrp,
    desired_rrs,
    desired_rra,
    desired_nrba,
    desired_nrda,
    desired_nraa,
    desired_nwba,
    desired_nwda,
    desired_nwaa,
    desired_wrp,
    desired_wrs,
    desired_wra,
    desired_wdm,
    desired_wds,
    desired_wda,
    desired_autosensitivityhigh,
    desired_autosensitivitylow,
    desired_averaging,
    desired_alarmrelease,
    livedb,
    livepfs,
    livetime,
    livesensitivity,
    liveoffset,
    liveflags,
    actual_alarmdelay,
    actual_tlvl,
    actual_dsu,
    desired_alarmdelay,
    desired_tlvl,
    desired_dsu
    FROM source

)

SELECT * FROM staged
